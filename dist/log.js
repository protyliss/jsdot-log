"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const $colors = {
    reset: '\x1b[0m',
    bright: '\x1b[1m',
    dim: '\x1b[2m',
    underscore: '\x1b[4m',
    blink: '\x1b[5m',
    reverse: '\x1b[7m',
    hidden: '\x1b[8m',
    black: '\x1b[30m',
    red: '\x1b[31m',
    green: '\x1b[32m',
    yellow: '\x1b[33m',
    blue: '\x1b[34m',
    magenta: '\x1b[35m',
    cyan: '\x1b[36m',
    white: '\x1b[37m',
    bgBlack: '\x1b[40m',
    bgRed: '\x1b[41m',
    bgGreen: '\x1b[42m',
    bgYellow: '\x1b[43m',
    bgBlue: '\x1b[44m',
    bgMagenta: '\x1b[45m',
    bgCyan: '\x1b[46m',
    bgWhite: '\x1b[47m'
};
const textColors = ['red', 'green', 'yellow', 'blue', 'magenta', 'cyan'];
const { reset } = $colors;
const _colorWrap = /\(([a-z.]+):([^()]+)\)/g;
const _colorArrow = /^([a-z.]+)=>$/;
class Log {
    constructor(_parent, prefix) {
        this._parent = _parent;
        this._prefix = '';
        this.flagIndex = 0;
        if (_parent) {
            if (prefix) {
                if (!Array.isArray(prefix)) {
                    prefix = [prefix];
                }
                this._prefix = '[' + setColorMap(prefix.join('')) + ']';
            }
        }
        else {
            this._parent = {
                getPrefix() {
                    return '[' + getTime() + ']';
                }
            };
        }
    }
    log(...messages) {
        console.log(this.getPrefix(), ...messages.map(setColorMap), reset);
    }
    info(...messages) {
        console.info(this.getPrefix(), ...messages.map(setColorMap), reset);
    }
    warn(...messages) {
        console.warn(this.getPrefix(), ...messages.map(setColorMap), reset);
    }
    error(...messages) {
        console.error(this.getPrefix(), ...messages.map(setColorMap), reset);
    }
    group(...messages) {
        console.group(this.getPrefix(), ...messages.map(setColorMap), reset);
    }
    groupEnd() {
        console.groupEnd();
    }
    child(prefix) {
        return new Log(this, prefix);
    }
    getPrefix() {
        return this._parent.getPrefix() + this._prefix;
    }
    title(message) {
        console.log('');
        console.log('');
        console.log('');
        console.log(message);
        console.log(getLine('=', message.length));
    }
    subTitle(message) {
        console.log('');
        console.log(message);
        console.log(getLine('-', message.length));
    }
    // flag(color?: TextColor);
    // flag(color) {
    //     if (!color) {
    //         if (++this.flagIndex > textColors.length) {
    //             this.flagIndex = 0;
    //         }
    //         color = $colors[textColors[this.flagIndex]];
    //     }
    //     console.log(color, '>>>>>----------------------->', reset);
    // }
    capture(...messages) {
        const line = $colors.red + getLine('*', 80);
        console.log(line);
        console.log(...messages);
        console.log(line, reset);
    }
    in(...message) {
        const arrow = '>>>>>----------------------->';
        console.log($colors.yellow);
        console.log(arrow);
        console.log(...message);
        console.log(arrow);
        console.log(reset);
    }
    out(...message) {
        const arrow = '<-----------------------<<<<<';
        console.log($colors.blue);
        console.log(arrow);
        console.log(...message);
        console.log(arrow);
        console.log(reset);
    }
}
Log.RESET = 'reset=>';
Log.BRIGHT = 'bright=>';
Log.DIM = 'dim=>';
Log.UNDERSCORE = 'underscore=>';
Log.BLINK = 'blink=>';
Log.REVERSE = 'reverse=>';
Log.HIDDEN = 'hidden=>';
Log.BLACK = 'black=>';
Log.RED = 'red=>';
Log.GREEN = 'green=>';
Log.YELLOW = 'yellow=>';
Log.BLUE = 'blue=>';
Log.MAGENTA = 'magenta=>';
Log.CYAN = 'cyna=>';
Log.WHITE = 'white=>';
Log.BGBLACK = 'bgblack=>';
Log.BGRED = 'bgred=>';
Log.BGGREEN = 'bggreen=>';
Log.BGYELLOW = 'bgyellow=>';
Log.BGBLUE = 'bgblue=>';
Log.BGMAGENTA = 'bgmagenta=>';
Log.BGCYAN = 'bgcyan=>';
Log.BGWHITE = 'bgwhite=>';
exports.Log = Log;
function setColorMap(message) {
    if (typeof message !== 'string') {
        return message;
    }
    const arrowed = message.match(_colorArrow);
    return arrowed ?
        getColors(arrowed[1]) :
        message.replace(_colorWrap, setColor);
}
function setColor(substring, colors, value) {
    return getColors(colors) + value + $colors.reset;
}
function getColors(colors) {
    return colors.split('.').map(getColorMap).join('');
}
function getColorMap(color) {
    return $colors[color] || $colors.reset;
}
const $lines = {};
function getLine(char, size) {
    if (!$lines[char]) {
        $lines[char] = {};
    }
    if (!$lines[char][size]) {
        let line = '';
        while (size-- > 0) {
            line += char;
        }
        $lines[char][size] = line;
    }
    return $lines[char][size];
}
function getTime() {
    const date = new Date;
    return [
        date.getHours(),
        date.getMinutes(),
        date.getSeconds()
    ]
        .map(zerofill)
        .join(':');
}
function zerofill(value) {
    return value < 10 ?
        '0' + value :
        value;
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFDLFFBQVEsQ0FBQztTQUNiLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNuQixDQUFDO0FBR0QsU0FBUyxRQUFRLENBQUMsS0FBSztJQUNuQixPQUFPLEtBQUssR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNmLEdBQUcsR0FBRyxLQUFLLENBQUMsQ0FBQztRQUNiLEtBQUssQ0FBQztBQUNkLENBQUMiLCJmaWxlIjoibG9nLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgJGNvbG9ycyA9IHtcclxuICAgIHJlc2V0OiAnXFx4MWJbMG0nLFxyXG4gICAgYnJpZ2h0OiAnXFx4MWJbMW0nLFxyXG4gICAgZGltOiAnXFx4MWJbMm0nLFxyXG4gICAgdW5kZXJzY29yZTogJ1xceDFiWzRtJyxcclxuICAgIGJsaW5rOiAnXFx4MWJbNW0nLFxyXG4gICAgcmV2ZXJzZTogJ1xceDFiWzdtJyxcclxuICAgIGhpZGRlbjogJ1xceDFiWzhtJyxcclxuICAgIGJsYWNrOiAnXFx4MWJbMzBtJyxcclxuICAgIHJlZDogJ1xceDFiWzMxbScsXHJcbiAgICBncmVlbjogJ1xceDFiWzMybScsXHJcbiAgICB5ZWxsb3c6ICdcXHgxYlszM20nLFxyXG4gICAgYmx1ZTogJ1xceDFiWzM0bScsXHJcbiAgICBtYWdlbnRhOiAnXFx4MWJbMzVtJyxcclxuICAgIGN5YW46ICdcXHgxYlszNm0nLFxyXG4gICAgd2hpdGU6ICdcXHgxYlszN20nLFxyXG4gICAgYmdCbGFjazogJ1xceDFiWzQwbScsXHJcbiAgICBiZ1JlZDogJ1xceDFiWzQxbScsXHJcbiAgICBiZ0dyZWVuOiAnXFx4MWJbNDJtJyxcclxuICAgIGJnWWVsbG93OiAnXFx4MWJbNDNtJyxcclxuICAgIGJnQmx1ZTogJ1xceDFiWzQ0bScsXHJcbiAgICBiZ01hZ2VudGE6ICdcXHgxYls0NW0nLFxyXG4gICAgYmdDeWFuOiAnXFx4MWJbNDZtJyxcclxuICAgIGJnV2hpdGU6ICdcXHgxYls0N20nXHJcbn07XHJcblxyXG50eXBlIFRleHRDb2xvciA9ICdyZWQnIHwgJ2dyZWVuJyB8ICd5ZWxsb3cnIHwgJ2JsdWUnIHwgJ21hZ2VudGEnIHwgJ2N5YW4nO1xyXG5jb25zdCB0ZXh0Q29sb3JzID0gWydyZWQnLCAnZ3JlZW4nLCAneWVsbG93JywgJ2JsdWUnLCAnbWFnZW50YScsICdjeWFuJ107XHJcblxyXG5jb25zdCB7cmVzZXR9ID0gJGNvbG9ycztcclxuXHJcbmNvbnN0IF9jb2xvcldyYXAgPSAvXFwoKFthLXouXSspOiguKylcXCkvZztcclxuY29uc3QgX2NvbG9yQXJyb3cgPSAvXihbYS16Ll0rKT0+JC87XHJcblxyXG5leHBvcnQgY2xhc3MgTG9nIHtcclxuICAgIF9wcmVmaXggPSAnJztcclxuXHJcbiAgICBzdGF0aWMgUkVTRVQgPSAncmVzZXQ9Pic7XHJcbiAgICBzdGF0aWMgQlJJR0hUID0gJ2JyaWdodD0+JztcclxuICAgIHN0YXRpYyBESU0gPSAnZGltPT4nO1xyXG4gICAgc3RhdGljIFVOREVSU0NPUkUgPSAndW5kZXJzY29yZT0+JztcclxuICAgIHN0YXRpYyBCTElOSyA9ICdibGluaz0+JztcclxuICAgIHN0YXRpYyBSRVZFUlNFID0gJ3JldmVyc2U9Pic7XHJcbiAgICBzdGF0aWMgSElEREVOID0gJ2hpZGRlbj0+JztcclxuICAgIHN0YXRpYyBCTEFDSyA9ICdibGFjaz0+JztcclxuICAgIHN0YXRpYyBSRUQgPSAncmVkPT4nO1xyXG4gICAgc3RhdGljIEdSRUVOID0gJ2dyZWVuPT4nO1xyXG4gICAgc3RhdGljIFlFTExPVyA9ICd5ZWxsb3c9Pic7XHJcbiAgICBzdGF0aWMgQkxVRSA9ICdibHVlPT4nO1xyXG4gICAgc3RhdGljIE1BR0VOVEEgPSAnbWFnZW50YT0+JztcclxuICAgIHN0YXRpYyBDWUFOID0gJ2N5bmE9Pic7XHJcbiAgICBzdGF0aWMgV0hJVEUgPSAnd2hpdGU9Pic7XHJcbiAgICBzdGF0aWMgQkdCTEFDSyA9ICdiZ2JsYWNrPT4nO1xyXG4gICAgc3RhdGljIEJHUkVEID0gJ2JncmVkPT4nO1xyXG4gICAgc3RhdGljIEJHR1JFRU4gPSAnYmdncmVlbj0+JztcclxuICAgIHN0YXRpYyBCR1lFTExPVyA9ICdiZ3llbGxvdz0+JztcclxuICAgIHN0YXRpYyBCR0JMVUUgPSAnYmdibHVlPT4nO1xyXG4gICAgc3RhdGljIEJHTUFHRU5UQSA9ICdiZ21hZ2VudGE9Pic7XHJcbiAgICBzdGF0aWMgQkdDWUFOID0gJ2JnY3lhbj0+JztcclxuICAgIHN0YXRpYyBCR1dISVRFID0gJ2Jnd2hpdGU9Pic7XHJcblxyXG4gICAgcHJvdGVjdGVkIGZsYWdJbmRleCA9IDA7XHJcblxyXG4gICAgY29uc3RydWN0b3IoX3BhcmVudD86IExvZywgcHJlZml4Pzogc3RyaW5nIHwgc3RyaW5nW10pO1xyXG4gICAgY29uc3RydWN0b3IocHJvdGVjdGVkIF9wYXJlbnQsIHByZWZpeCkge1xyXG4gICAgICAgIGlmIChfcGFyZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChwcmVmaXgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShwcmVmaXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJlZml4ID0gW3ByZWZpeF07XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJlZml4ID0gJ1snICsgc2V0Q29sb3JNYXAocHJlZml4LmpvaW4oJycpKSArICddJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BhcmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGdldFByZWZpeCgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ1snICsgZ2V0VGltZSgpICsgJ10nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxvZyguLi5tZXNzYWdlcykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZ2V0UHJlZml4KCksIC4uLm1lc3NhZ2VzLm1hcChzZXRDb2xvck1hcCksIHJlc2V0KTtcclxuICAgIH1cclxuXHJcbiAgICBpbmZvKC4uLm1lc3NhZ2VzKSB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKHRoaXMuZ2V0UHJlZml4KCksIC4uLm1lc3NhZ2VzLm1hcChzZXRDb2xvck1hcCksIHJlc2V0KTtcclxuICAgIH1cclxuXHJcbiAgICB3YXJuKC4uLm1lc3NhZ2VzKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKHRoaXMuZ2V0UHJlZml4KCksIC4uLm1lc3NhZ2VzLm1hcChzZXRDb2xvck1hcCksIHJlc2V0KTtcclxuICAgIH1cclxuXHJcbiAgICBlcnJvciguLi5tZXNzYWdlcykge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5nZXRQcmVmaXgoKSwgLi4ubWVzc2FnZXMubWFwKHNldENvbG9yTWFwKSwgcmVzZXQpO1xyXG4gICAgfVxyXG5cclxuICAgIGdyb3VwKC4uLm1lc3NhZ2VzKSB7XHJcbiAgICAgICAgY29uc29sZS5ncm91cCh0aGlzLmdldFByZWZpeCgpLCAuLi5tZXNzYWdlcy5tYXAoc2V0Q29sb3JNYXApLCByZXNldCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ3JvdXBFbmQoKSB7XHJcbiAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNoaWxkKHByZWZpeDogc3RyaW5nIHwgc3RyaW5nW10pIHtcclxuICAgICAgICByZXR1cm4gbmV3IExvZyh0aGlzLCBwcmVmaXgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFByZWZpeCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcGFyZW50LmdldFByZWZpeCgpICsgdGhpcy5fcHJlZml4O1xyXG4gICAgfVxyXG5cclxuICAgIHRpdGxlKG1lc3NhZ2UpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnJyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJycpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCcnKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhnZXRMaW5lKCc9JywgbWVzc2FnZS5sZW5ndGgpKTtcclxuICAgIH1cclxuXHJcbiAgICBzdWJUaXRsZShtZXNzYWdlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJycpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGdldExpbmUoJy0nLCBtZXNzYWdlLmxlbmd0aCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGZsYWcoY29sb3I/OiBUZXh0Q29sb3IpO1xyXG4gICAgLy8gZmxhZyhjb2xvcikge1xyXG4gICAgLy8gICAgIGlmICghY29sb3IpIHtcclxuICAgIC8vICAgICAgICAgaWYgKCsrdGhpcy5mbGFnSW5kZXggPiB0ZXh0Q29sb3JzLmxlbmd0aCkge1xyXG4gICAgLy8gICAgICAgICAgICAgdGhpcy5mbGFnSW5kZXggPSAwO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIGNvbG9yID0gJGNvbG9yc1t0ZXh0Q29sb3JzW3RoaXMuZmxhZ0luZGV4XV07XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICAgIGNvbnNvbGUubG9nKGNvbG9yLCAnPj4+Pj4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT4nLCByZXNldCk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgY2FwdHVyZSguLi5tZXNzYWdlcykge1xyXG4gICAgICAgIGNvbnN0IGxpbmUgPSAkY29sb3JzLnJlZCArIGdldExpbmUoJyonLCA4MCk7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKGxpbmUpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKC4uLm1lc3NhZ2VzKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhsaW5lLCByZXNldCk7XHJcbiAgICB9XHJcblxyXG4gICAgaW4oLi4ubWVzc2FnZSkge1xyXG4gICAgICAgIGNvbnN0IGFycm93ID0gJz4+Pj4+LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0+JztcclxuICAgICAgICBjb25zb2xlLmxvZygkY29sb3JzLnllbGxvdyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYXJyb3cpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKC4uLm1lc3NhZ2UpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGFycm93KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXNldCk7XHJcbiAgICB9XHJcblxyXG4gICAgb3V0KC4uLm1lc3NhZ2UpIHtcclxuICAgICAgICBjb25zdCBhcnJvdyA9ICc8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS08PDw8PCc7XHJcbiAgICAgICAgY29uc29sZS5sb2coJGNvbG9ycy5ibHVlKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhhcnJvdyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coLi4ubWVzc2FnZSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYXJyb3cpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlc2V0KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2V0Q29sb3JNYXAobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nO1xyXG5mdW5jdGlvbiBzZXRDb2xvck1hcChtZXNzYWdlKSB7XHJcbiAgICBpZiAodHlwZW9mIG1lc3NhZ2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XHJcbiAgICB9XHJcbiAgICBjb25zdCBhcnJvd2VkID0gbWVzc2FnZS5tYXRjaChfY29sb3JBcnJvdyk7XHJcbiAgICByZXR1cm4gYXJyb3dlZCA/XHJcbiAgICAgICAgZ2V0Q29sb3JzKGFycm93ZWRbMV0pIDpcclxuICAgICAgICBtZXNzYWdlLnJlcGxhY2UoX2NvbG9yV3JhcCwgc2V0Q29sb3IpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRDb2xvcihzdWJzdHJpbmc6IHN0cmluZywgY29sb3JzOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiBzdHJpbmc7XHJcbmZ1bmN0aW9uIHNldENvbG9yKHN1YnN0cmluZywgY29sb3JzLCB2YWx1ZSkge1xyXG4gICAgcmV0dXJuIGdldENvbG9ycyhjb2xvcnMpICsgdmFsdWUgKyAkY29sb3JzLnJlc2V0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDb2xvcnMoY29sb3JzOiBzdHJpbmcpOiBzdHJpbmc7XHJcbmZ1bmN0aW9uIGdldENvbG9ycyhjb2xvcnMpIHtcclxuICAgIHJldHVybiBjb2xvcnMuc3BsaXQoJy4nKS5tYXAoZ2V0Q29sb3JNYXApLmpvaW4oJycpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDb2xvck1hcChjb2xvcjogc3RyaW5nKTogc3RyaW5nO1xyXG5mdW5jdGlvbiBnZXRDb2xvck1hcChjb2xvcikge1xyXG4gICAgcmV0dXJuICRjb2xvcnNbY29sb3JdIHx8ICRjb2xvcnMucmVzZXQ7XHJcbn1cclxuXHJcbmNvbnN0ICRsaW5lczoge1xyXG4gICAgW2tleTogc3RyaW5nXToge1xyXG4gICAgICAgIFtrZXk6IG51bWJlcl06IHN0cmluZ1xyXG4gICAgfVxyXG59XHJcbiAgICA9IHt9O1xyXG5cclxuZnVuY3Rpb24gZ2V0TGluZShjaGFyOiBzdHJpbmcsIHNpemU6IG51bWJlcik6IHN0cmluZztcclxuZnVuY3Rpb24gZ2V0TGluZShjaGFyLCBzaXplKSB7XHJcbiAgICBpZiAoISRsaW5lc1tjaGFyXSkge1xyXG4gICAgICAgICRsaW5lc1tjaGFyXSA9IHt9O1xyXG4gICAgfVxyXG4gICAgaWYgKCEkbGluZXNbY2hhcl1bc2l6ZV0pIHtcclxuICAgICAgICBsZXQgbGluZSA9ICcnO1xyXG4gICAgICAgIHdoaWxlIChzaXplLS0gPiAwKSB7XHJcbiAgICAgICAgICAgIGxpbmUgKz0gY2hhcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgJGxpbmVzW2NoYXJdW3NpemVdID0gbGluZTtcclxuICAgIH1cclxuICAgIHJldHVybiAkbGluZXNbY2hhcl1bc2l6ZV07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRpbWUoKSB7XHJcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGU7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICAgIGRhdGUuZ2V0SG91cnMoKSxcclxuICAgICAgICBkYXRlLmdldE1pbnV0ZXMoKSxcclxuICAgICAgICBkYXRlLmdldFNlY29uZHMoKVxyXG4gICAgXVxyXG4gICAgICAgIC5tYXAoemVyb2ZpbGwpXHJcbiAgICAgICAgLmpvaW4oJzonKTtcclxufVxyXG5cclxuZnVuY3Rpb24gemVyb2ZpbGwodmFsdWU6IG51bWJlcik6IHN0cmluZyB8IG51bWJlcjtcclxuZnVuY3Rpb24gemVyb2ZpbGwodmFsdWUpIHtcclxuICAgIHJldHVybiB2YWx1ZSA8IDEwID9cclxuICAgICAgICAnMCcgKyB2YWx1ZSA6XHJcbiAgICAgICAgdmFsdWU7XHJcbn1cclxuIl19
